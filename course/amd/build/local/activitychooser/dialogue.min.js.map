{"version":3,"sources":["../../../src/local/activitychooser/dialogue.js"],"names":["showModuleHelp","carousel","moduleData","help","find","selectors","regions","innerHTML","spinnerPromise","transitionPromiseResolver","transitionPromise","Promise","resolve","contentPromise","Templates","renderForPromise","all","then","html","js","replaceNodeContents","querySelector","chooserSummary","description","focus","catch","Notification","exception","one","registerListenerEvents","modal","mappedModules","bodyClickListener","e","target","closest","actions","optionActions","showSummary","getBody","module","chooserOption","container","moduleName","dataset","modname","get","matches","closeOption","on","allModules","modules","caller","getModuleSelector","clearSearch","searchInput","search","value","toggleSearchResultsView","getBodyPromise","body","interval","pause","keyboard","addEventListener","activeSectionId","elements","activetab","getAttribute","sectionChooserOptions","getSectionChooserOptions","firstChooserOption","toggleFocusableChoserOption","initTabsKeyboardNavigation","initChooserOptionsKeyboardNavigation","favTabNav","favouriteTabNav","recommendedTabNav","defaultTabNav","forEach","element","firstLink","parentElement","firstElementChild","lastLink","lastElementChild","keyCode","arrowRight","nextLink","nextElementSibling","srcElement","tabIndex","classList","contains","arrowLeft","previousLink","previousElementSibling","home","end","space","preventDefault","click","chooserOptionsContainer","chooserOptions","querySelectorAll","Array","from","enter","currentOption","nextOption","firstOption","toFocusOption","clickErrorHandler","focusChooserOption","previousOption","lastOption","currentChooserOption","previousChooserOption","isFocusable","chooserOptionLink","addChooser","chooserOptionHelp","item","fallback","renderSearchResults","searchResultsContainer","searchResultsData","templateData","length","modalBody","searchQuery","searchResults","chooserContainer","chooser","clearSearchButton","clearsearch","searchIcon","searchicon","searchModules","searchResultItemsContainer","searchResultItems","firstSearchResultItem","add","remove","setAttribute","removeAttribute","searchTerm","toLowerCase","activity","activityName","title","activityDesc","includes","push","disableFocusAllChooserOptions","allChooserOptions","displayChooser","origin","sectionModules","Map","set","componentname","link","getRoot","ModalEvents","hidden","destroy","shown","getModal","tab","activeSectionChooserOptions","prevActiveSectionId","relatedTarget","prevActiveSectionChooserOptions","show"],"mappings":"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","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * A type of dialogue used as for choosing options.\n *\n * @module     core_course/local/chooser/dialogue\n * @package    core\n * @copyright  2019 Mihail Geshoski <mihail@moodle.com>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport $ from 'jquery';\nimport * as ModalEvents from 'core/modal_events';\nimport selectors from 'core_course/local/activitychooser/selectors';\nimport * as Templates from 'core/templates';\nimport {end, arrowLeft, arrowRight, home, enter, space} from 'core/key_codes';\nimport {addIconToContainer} from 'core/loadingicon';\nimport {debounce} from 'core/utils';\n\n/**\n * Given an event from the main module 'page' navigate to it's help section via a carousel.\n *\n * @method showModuleHelp\n * @param {jQuery} carousel Our initialized carousel to manipulate\n * @param {Object} moduleData Data of the module to carousel to\n */\nconst showModuleHelp = (carousel, moduleData) => {\n    const help = carousel.find(selectors.regions.help)[0];\n    help.innerHTML = '';\n\n    // Add a spinner.\n    const spinnerPromise = addIconToContainer(help);\n\n    // Used later...\n    let transitionPromiseResolver = null;\n    const transitionPromise = new Promise(resolve => {\n        transitionPromiseResolver = resolve;\n    });\n\n    // Build up the html & js ready to place into the help section.\n    const contentPromise = Templates.renderForPromise('core_course/chooser_help', moduleData);\n\n    // Wait for the content to be ready, and for the transition to be complet.\n    Promise.all([contentPromise, spinnerPromise, transitionPromise])\n        .then(([{html, js}]) => Templates.replaceNodeContents(help, html, js))\n        .then(() => {\n            help.querySelector(selectors.regions.chooserSummary.description).focus();\n            return help;\n        })\n        .catch(Notification.exception);\n\n    // Move to the next slide, and resolve the transition promise when it's done.\n    carousel.one('slid.bs.carousel', () => {\n        transitionPromiseResolver();\n    });\n    // Trigger the transition between 'pages'.\n    carousel.carousel('next');\n};\n\n/**\n * Register chooser related event listeners.\n *\n * @method registerListenerEvents\n * @param {Promise} modal Our modal that we are working with\n * @param {Map} mappedModules A map of all of the modules we are working with with K: mod_name V: {Object}\n */\nconst registerListenerEvents = (modal, mappedModules) => {\n    const bodyClickListener = e => {\n        if (e.target.closest(selectors.actions.optionActions.showSummary)) {\n            const carousel = $(modal.getBody()[0].querySelector(selectors.regions.carousel));\n\n            const module = e.target.closest(selectors.regions.chooserOption.container);\n            const moduleName = module.dataset.modname;\n            const moduleData = mappedModules.get(moduleName);\n            showModuleHelp(carousel, moduleData);\n        }\n\n        // From the help screen go back to the module overview.\n        if (e.target.matches(selectors.actions.closeOption)) {\n            const carousel = $(modal.getBody()[0].querySelector(selectors.regions.carousel));\n\n            // Trigger the transition between 'pages'.\n            carousel.carousel('prev');\n            carousel.on('slid.bs.carousel', () => {\n                const allModules = modal.getBody()[0].querySelector(selectors.regions.modules);\n                const caller = allModules.querySelector(selectors.regions.getModuleSelector(e.target.dataset.modname));\n                caller.focus();\n            });\n        }\n\n        // The \"clear search\" button is triggered.\n        if (e.target.matches(selectors.actions.clearSearch)) {\n            // Clear the entered search query in the search bar and hide the search results container.\n            const searchInput = modal.getBody()[0].querySelector(selectors.actions.search);\n            searchInput.value = \"\";\n            searchInput.focus();\n            toggleSearchResultsView(modal.getBody()[0], mappedModules, searchInput.value);\n        }\n    };\n\n    modal.getBodyPromise()\n\n    // The return value of getBodyPromise is a jquery object containing the body NodeElement.\n    .then(body => body[0])\n\n    // Set up the carousel.\n    .then(body => {\n        $(body.querySelector(selectors.regions.carousel))\n            .carousel({\n                interval: false,\n                pause: true,\n                keyboard: false\n            });\n\n        return body;\n    })\n\n    // Add the listener for clicks on the body.\n    .then(body => {\n        body.addEventListener('click', bodyClickListener);\n        return body;\n    })\n\n    // Add a listener for an input change in the activity chooser's search bar.\n    .then(body => {\n        const searchInput = body.querySelector(selectors.actions.search);\n        // The search input is triggered.\n        searchInput.addEventListener('input', debounce(() => {\n            // Display the search results.\n            toggleSearchResultsView(body, mappedModules, searchInput.value);\n        }, 300));\n        return body;\n    })\n\n    // Register event listeners related to the keyboard navigation controls.\n    .then(body => {\n        // Get the active chooser options section.\n        const activeSectionId = body.querySelector(selectors.elements.activetab).getAttribute(\"href\");\n        const sectionChooserOptions = body.querySelector(selectors.regions.getSectionChooserOptions(activeSectionId));\n        const firstChooserOption = sectionChooserOptions.querySelector(selectors.regions.chooserOption.container);\n        toggleFocusableChoserOption(firstChooserOption, true);\n        initTabsKeyboardNavigation(body);\n        initChooserOptionsKeyboardNavigation(body, mappedModules, sectionChooserOptions);\n        return body;\n    })\n    .catch();\n\n};\n\n/**\n * Initialise the keyboard navigation controls for the tab list items.\n *\n * @method initTabsKeyboardNavigation\n * @param {HTMLElement} body Our modal that we are working with\n */\nconst initTabsKeyboardNavigation = (body) => {\n    // Set up the tab handlers.\n    const favTabNav = body.querySelector(selectors.regions.favouriteTabNav);\n    const recommendedTabNav = body.querySelector(selectors.regions.recommendedTabNav);\n    const defaultTabNav = body.querySelector(selectors.regions.defaultTabNav);\n    const tabNavArray = [favTabNav, recommendedTabNav, defaultTabNav];\n    tabNavArray.forEach((element) => {\n        return element.addEventListener('keyup', (e) => {\n            const firstLink = e.target.parentElement.parentElement.firstElementChild.firstElementChild;\n            const lastLink = e.target.parentElement.parentElement.lastElementChild.firstElementChild;\n\n            if (e.keyCode === arrowRight) {\n                const nextLink = e.target.parentElement.nextElementSibling;\n                if (nextLink === null) {\n                    e.srcElement.tabIndex = -1;\n                    firstLink.tabIndex = 0;\n                    firstLink.focus();\n                } else if (nextLink.firstElementChild.classList.contains('d-none')) {\n                    e.srcElement.tabIndex = -1;\n                    lastLink.tabIndex = 0;\n                    lastLink.focus();\n                } else {\n                    e.srcElement.tabIndex = -1;\n                    nextLink.firstElementChild.tabIndex = 0;\n                    nextLink.firstElementChild.focus();\n                }\n            }\n            if (e.keyCode === arrowLeft) {\n                const previousLink = e.target.parentElement.previousElementSibling;\n                if (previousLink === null) {\n                    e.srcElement.tabIndex = -1;\n                    lastLink.tabIndex = 0;\n                    lastLink.focus();\n                } else if (previousLink.firstElementChild.classList.contains('d-none')) {\n                    e.srcElement.tabIndex = -1;\n                    firstLink.tabIndex = 0;\n                    firstLink.focus();\n                } else {\n                    e.srcElement.tabIndex = -1;\n                    previousLink.firstElementChild.tabIndex = 0;\n                    previousLink.firstElementChild.focus();\n                }\n            }\n            if (e.keyCode === home) {\n                e.srcElement.tabIndex = -1;\n                firstLink.tabIndex = 0;\n                firstLink.focus();\n            }\n            if (e.keyCode === end) {\n                e.srcElement.tabIndex = -1;\n                lastLink.tabIndex = 0;\n                lastLink.focus();\n            }\n            if (e.keyCode === space) {\n                e.preventDefault();\n                e.target.click();\n            }\n        });\n    });\n};\n\n/**\n * Initialise the keyboard navigation controls for the chooser options.\n *\n * @method initChooserOptionsKeyboardNavigation\n * @param {HTMLElement} body Our modal that we are working with\n * @param {Map} mappedModules A map of all of the modules we are working with with K: mod_name V: {Object}\n * @param {HTMLElement} chooserOptionsContainer The section that contains the chooser items\n */\nconst initChooserOptionsKeyboardNavigation = (body, mappedModules, chooserOptionsContainer) => {\n    const chooserOptions = chooserOptionsContainer.querySelectorAll(selectors.regions.chooserOption.container);\n\n    Array.from(chooserOptions).forEach((element) => {\n        return element.addEventListener('keyup', (e) => {\n\n            // Check for enter/ space triggers for showing the help.\n            if (e.keyCode === enter || e.keyCode === space) {\n                if (e.target.matches(selectors.actions.optionActions.showSummary)) {\n                    e.preventDefault();\n                    const module = e.target.closest(selectors.regions.chooserOption.container);\n                    const moduleName = module.dataset.modname;\n                    const moduleData = mappedModules.get(moduleName);\n                    const carousel = $(body.querySelector(selectors.regions.carousel));\n                    carousel.carousel({\n                        interval: false,\n                        pause: true,\n                        keyboard: false\n                    });\n                    showModuleHelp(carousel, moduleData);\n                }\n            }\n\n            // Next.\n            if (e.keyCode === arrowRight) {\n                e.preventDefault();\n                const currentOption = e.target.closest(selectors.regions.chooserOption.container);\n                const nextOption = currentOption.nextElementSibling;\n                const firstOption = chooserOptionsContainer.firstElementChild;\n                const toFocusOption = clickErrorHandler(nextOption, firstOption);\n                focusChooserOption(toFocusOption, currentOption);\n            }\n\n            // Previous.\n            if (e.keyCode === arrowLeft) {\n                e.preventDefault();\n                const currentOption = e.target.closest(selectors.regions.chooserOption.container);\n                const previousOption = currentOption.previousElementSibling;\n                const lastOption = chooserOptionsContainer.lastElementChild;\n                const toFocusOption = clickErrorHandler(previousOption, lastOption);\n                focusChooserOption(toFocusOption, currentOption);\n            }\n\n            if (e.keyCode === home) {\n                e.preventDefault();\n                const currentOption = e.target.closest(selectors.regions.chooserOption.container);\n                const firstOption = chooserOptionsContainer.firstElementChild;\n                focusChooserOption(firstOption, currentOption);\n            }\n\n            if (e.keyCode === end) {\n                e.preventDefault();\n                const currentOption = e.target.closest(selectors.regions.chooserOption.container);\n                const lastOption = chooserOptionsContainer.lastElementChild;\n                focusChooserOption(lastOption, currentOption);\n            }\n        });\n    });\n};\n\n/**\n * Focus on a chooser option element and remove the previous chooser element from the focus order\n *\n * @method focusChooserOption\n * @param {HTMLElement} currentChooserOption The current chooser option element that we want to focus\n * @param {HTMLElement|null} previousChooserOption The previous focused option element\n */\nconst focusChooserOption = (currentChooserOption, previousChooserOption = null) => {\n    if (previousChooserOption !== null) {\n        toggleFocusableChoserOption(previousChooserOption, false);\n    }\n\n    toggleFocusableChoserOption(currentChooserOption, true);\n    currentChooserOption.focus();\n};\n\n/**\n * Add or remove a chooser option from the focus order.\n *\n * @method toggleFocusableChoserOption\n * @param {HTMLElement} chooserOption The chooser option element which should be added or removed from the focus order\n * @param {Boolean} isFocusable Whether the chooser element is focusable or not\n */\nconst toggleFocusableChoserOption = (chooserOption, isFocusable) => {\n    const chooserOptionLink = chooserOption.querySelector(selectors.actions.addChooser);\n    const chooserOptionHelp = chooserOption.querySelector(selectors.actions.optionActions.showSummary);\n\n    if (isFocusable) {\n        // Set tabindex to 0 to add current chooser option element to the focus order.\n        chooserOption.tabIndex = 0;\n        chooserOptionLink.tabIndex = 0;\n        chooserOptionHelp.tabIndex = 0;\n    } else {\n        // Set tabindex to -1 to remove the previous chooser option element from the focus order.\n        chooserOption.tabIndex = -1;\n        chooserOptionLink.tabIndex = -1;\n        chooserOptionHelp.tabIndex = -1;\n    }\n};\n\n/**\n * Small error handling function to make sure the navigated to object exists\n *\n * @method clickErrorHandler\n * @param {HTMLElement} item What we want to check exists\n * @param {HTMLElement} fallback If we dont match anything fallback the focus\n * @return {HTMLElement}\n */\nconst clickErrorHandler = (item, fallback) => {\n    if (item !== null) {\n        return item;\n    } else {\n        return fallback;\n    }\n};\n\n/**\n * Render the search results in a defined container\n *\n * @method renderSearchResults\n * @param {HTMLElement} searchResultsContainer The container where the data should be rendered\n * @param {Object} searchResultsData Data containing the module items that satisfy the search criteria\n */\nconst renderSearchResults = async(searchResultsContainer, searchResultsData) => {\n    const templateData = {\n        'searchresultsnumber': searchResultsData.length,\n        'searchresults': searchResultsData\n    };\n    // Build up the html & js ready to place into the help section.\n    const {html, js} = await Templates.renderForPromise('core_course/chooser_search_results', templateData);\n    await Templates.replaceNodeContents(searchResultsContainer, html, js);\n};\n\n/**\n * Toggle (display/hide) the search results depending on the value of the search query\n *\n * @method toggleSearchResultsView\n * @param {HTMLElement} modalBody The body of the created modal for the section\n * @param {Map} mappedModules A map of all of the modules we are working with with K: mod_name V: {Object}\n * @param {String} searchQuery The search query\n */\nconst toggleSearchResultsView = async(modalBody, mappedModules, searchQuery) => {\n    const searchResultsContainer = modalBody.querySelector(selectors.regions.searchResults);\n    const chooserContainer = modalBody.querySelector(selectors.regions.chooser);\n    const clearSearchButton = modalBody.querySelector(selectors.elements.clearsearch);\n    const searchIcon = modalBody.querySelector(selectors.elements.searchicon);\n\n    if (searchQuery.length > 0) { // Search query is present.\n        const searchResultsData = searchModules(mappedModules, searchQuery);\n        await renderSearchResults(searchResultsContainer, searchResultsData);\n        const searchResultItemsContainer = searchResultsContainer.querySelector(selectors.regions.searchResultItems);\n        const firstSearchResultItem = searchResultItemsContainer.querySelector(selectors.regions.chooserOption.container);\n        if (firstSearchResultItem) {\n            // Set the first result item to be focusable.\n            toggleFocusableChoserOption(firstSearchResultItem, true);\n            // Register keyboard events on the created search result items.\n            initChooserOptionsKeyboardNavigation(modalBody, mappedModules, searchResultItemsContainer);\n        }\n        // Display the \"clear\" search button in the activity chooser search bar.\n        searchIcon.classList.add('d-none');\n        clearSearchButton.classList.remove('d-none');\n        // Hide the default chooser options container.\n        chooserContainer.setAttribute('hidden', 'hidden');\n        // Display the search results container.\n        searchResultsContainer.removeAttribute('hidden');\n    } else { // Search query is not present.\n        // Hide the \"clear\" search button in the activity chooser search bar.\n        clearSearchButton.classList.add('d-none');\n        searchIcon.classList.remove('d-none');\n        // Hide the search results container.\n        searchResultsContainer.setAttribute('hidden', 'hidden');\n        // Display the default chooser options container.\n        chooserContainer.removeAttribute('hidden');\n    }\n};\n\n/**\n * Return the list of modules which have a name or description that matches the given search term.\n *\n * @method searchModules\n * @param {Array} modules List of available modules\n * @param {String} searchTerm The search term to match\n * @return {Array}\n */\nconst searchModules = (modules, searchTerm) => {\n    if (searchTerm === '') {\n        return modules;\n    }\n    searchTerm = searchTerm.toLowerCase();\n    const searchResults = [];\n    modules.forEach((activity) => {\n        const activityName = activity.title.toLowerCase();\n        const activityDesc = activity.help.toLowerCase();\n        if (activityName.includes(searchTerm) || activityDesc.includes(searchTerm)) {\n            searchResults.push(activity);\n        }\n    });\n\n    return searchResults;\n};\n\n/**\n * Disable the focus of all chooser options in a specific container (section).\n *\n * @method disableFocusAllChooserOptions\n * @param {HTMLElement} sectionChooserOptions The section that contains the chooser items\n */\nconst disableFocusAllChooserOptions = (sectionChooserOptions) => {\n    const allChooserOptions = sectionChooserOptions.querySelectorAll(selectors.regions.chooserOption.container);\n    allChooserOptions.forEach((chooserOption) => {\n        toggleFocusableChoserOption(chooserOption, false);\n    });\n};\n\n/**\n * Display the module chooser.\n *\n * @method displayChooser\n * @param {HTMLElement} origin The calling button\n * @param {Object} modal Our created modal for the section\n * @param {Array} sectionModules An array of all of the built module information\n */\nexport const displayChooser = (origin, modal, sectionModules) => {\n\n    // Make a map so we can quickly fetch a specific module's object for either rendering or searching.\n    const mappedModules = new Map();\n    sectionModules.forEach((module) => {\n        mappedModules.set(module.componentname + '_' + module.link, module);\n    });\n\n    // Register event listeners.\n    registerListenerEvents(modal, mappedModules);\n\n    // We want to focus on the action select when the dialog is closed.\n    modal.getRoot().on(ModalEvents.hidden, () => {\n        modal.destroy();\n    });\n\n    // We want to focus on the first chooser option element as soon as the modal is opened.\n    modal.getRoot().on(ModalEvents.shown, () => {\n        modal.getModal()[0].tabIndex = -1;\n\n        modal.getBodyPromise()\n        .then(body => {\n            $(selectors.elements.tab).on('shown.bs.tab', (e) => {\n                const activeSectionId = e.target.getAttribute(\"href\");\n                const activeSectionChooserOptions = body[0]\n                    .querySelector(selectors.regions.getSectionChooserOptions(activeSectionId));\n                const firstChooserOption = activeSectionChooserOptions\n                    .querySelector(selectors.regions.chooserOption.container);\n                const prevActiveSectionId = e.relatedTarget.getAttribute(\"href\");\n                const prevActiveSectionChooserOptions = body[0]\n                    .querySelector(selectors.regions.getSectionChooserOptions(prevActiveSectionId));\n\n                // Disable the focus of every chooser option in the previous active section.\n                disableFocusAllChooserOptions(prevActiveSectionChooserOptions);\n                // Enable the focus of the first chooser option in the current active section.\n                toggleFocusableChoserOption(firstChooserOption, true);\n                initChooserOptionsKeyboardNavigation(body[0], mappedModules, activeSectionChooserOptions);\n                return;\n            });\n        })\n        .catch(Notification.exception);\n    });\n\n    modal.show();\n};\n"],"file":"dialogue.min.js"}