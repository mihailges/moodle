define(["jquery","core/ajax","core/str","core/templates","core/notification","mod_forum/repository","mod_forum/selectors","core/str"],function(a,b,c,d,e,f,g,h){var i=function(b){b.on("click",g.pin.toggle,function(b){var c=a(this),g=c.data("forumid"),i=c.data("discussionid"),j=c.data("targetstate");f.setPinDiscussionState(g,i,j).then(function(a){return d.render("mod_forum/discussion_pin_toggle",a)}).then(function(a,b){return d.replaceNode(c,a,b)}).then(function(){return h.get_string("pinupdated","forum").done(function(b){var c=null,d={flash:!0},f=e.getNotificationElements(d);a.each(f,function(b,d){if("info"==a(d).data("type"))return c=d,f.splice(b,1),!1}),e.clearNotificationElements(f),null!==c?e.updateNotification(c,b):e.addNotification({message:b,type:"info",flash:!0})})}).fail(e.exception),b.preventDefault()})};return{init:function(a){i(a)}}});