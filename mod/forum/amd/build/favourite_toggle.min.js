define(["jquery","core/templates","core/notification","mod_forum/repository","mod_forum/selectors","core/str"],function(a,b,c,d,e,f){var g=function(g){g.on("click",e.favourite.toggle,function(e){var g=a(this),h=g.data("forumid"),i=g.data("discussionid"),j=g.data("targetstate");d.setFavouriteDiscussionState(h,i,j).then(function(a){return b.render("mod_forum/discussion_favourite_toggle",a)}).then(function(a,c){return b.replaceNode(g,a,c)}).then(function(){return f.get_string("favouriteupdated","forum").done(function(b){var d=null,e={flash:!0},f=c.getNotificationElements(e);a.each(f,function(b,c){if("info"==a(c).data("type"))return d=c,f.splice(b,1),!1}),c.clearNotificationElements(f),null!==d?c.updateNotification(d,b):c.addNotification({message:b,type:"info",flash:!0})})})["catch"](c.exception),e.preventDefault()})};return{init:function(a){g(a)}}});