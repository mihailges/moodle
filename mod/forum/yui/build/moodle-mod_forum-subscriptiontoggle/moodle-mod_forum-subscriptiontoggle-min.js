YUI.add("moodle-mod_forum-subscriptiontoggle",function(c,e){function i(){i.superclass.constructor.apply(this,arguments)}c.extend(i,c.Base,{initializer:function(){c.delegate("click",this._toggleSubscription,c.config.doc.body,".discussionsubscription .discussiontoggle",this)},_toggleSubscription:function(e){var i=e.currentTarget;c.io(this.get("uri"),{data:{sesskey:M.cfg.sesskey,forumid:i.getData("forumid"),discussionid:i.getData("discussionid"),includetext:i.getData("includetext")},context:this,arguments:{clickedLink:i},on:{complete:this._handleCompletion}}),e.preventDefault()},_handleCompletion:function(e,i,t){var o,n;try{if((o=c.JSON.parse(i.response)).error)return c.use("moodle-core-notification-ajaxexception",function(){return new M.core.ajaxException(o)}),this}catch(s){return c.use("moodle-core-notification-exception",function(){return new M.core.exception(s)}),this}o.icon&&(n=t.clickedLink.ancestor(".discussionsubscription"))&&n.set("innerHTML",o.icon)}},{NAME:"subscriptionToggle",ATTRS:{uri:{value:M.cfg.wwwroot+"/mod/forum/subscribe_ajax.php"}}}),c.namespace("M.mod_forum.subscriptiontoggle").init=function(e){return new i(e)}},"@VERSION@",{requires:["base-base","io-base"]});