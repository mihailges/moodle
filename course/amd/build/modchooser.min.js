define(["core/yui","jquery","core/activity_chooser_dialogue"],function(a,b,c){var d={PAGECONTENT:"body",SECTION:null,SECTIONMODCHOOSER:"span.section-modchooser-link",SITEMENU:".block_site_main_menu",SITETOPIC:"div.sitetopic"},e=function(a){if(a.target.ancestor(d.SITETOPIC))this.sectionid=1;else if(a.target.ancestor(d.SECTION)){var b=a.target.ancestor(d.SECTION);this.sectionid=b.attr("id").replace("section-","")}else a.target.ancestor(d.SITEMENU)&&(this.sectionid=0);c.displayChooser(a)},f=function(a){var b=a.find(d.SECTIONMODCHOOSER);if(b){var c="<a href='#' />";b.children().each(function(a){c.appendChild(a)}),b.insertBefore(c),c.on("click",e(),this)}},g=function(a){a||(a=d.PAGECONTENT),b(a).all(d.SITETOPIC).each(function(a){f(a)},this),d.SECTION&&b(a).all(d.SECTION).each(function(a){f(a)},this),b(a).all(d.SITEMENU).each(function(a){this._setupForSection(a)},this)},h=function(){var a=M.course.format.get_sectionwrapperclass();a&&(d.SECTION="."+a);var e=b(".chooserdialoguebody"),f=b(".choosertitle"),h={};c.setupChooserDialogue(e,f,h),g(),M.course.coursebase.register_module(this)};return{init:h()}});