{"version":3,"sources":["../src/activity_chooser_dialogue.js"],"names":["define","Y","$","PubSub","ActivityChooserEvents","FocusLock","panel","container","options","listenevents","bodycontent","headercontent","instanceconfig","ATTRS","minheight","baseheight","maxheight","closeButtonTitle","validator","Lang","isString","value","cancelListenevents","thisevent","length","shift","off","hide","cancelPopup","e","preventDefault","_getClassNames","args","results","push","toLowerCase","arg","prepareChooser","addClass","paramkey","params","bodyContent","html","headerContent","width","draggable","visible","zindex","modal","shim","focusOnPreviousTargetAfterHide","render","extraClasses","M","core","dialogue","remove","get","one","getDOMNode","find","firstOption","attr","moreinfolinks","each","key","moreinfolink","centerDialogue","bb","winheight","newheight","totalheight","shouldResizeFullscreen","lockScroll","isActive","enableScrollLock","disableScrollLock","css","dialogueheight","getStyle","match","replace","updateHiddenRadioValue","name","optionSelected","publish","OPTION_SELECTED","openTypeSummary","typeSummaryElement","position","scrollTop","height","outerHeight","setTypeSummaryPositionAndHeight","typeSummaryContentElement","cancelAction","addAction","trapFocus","element","typeSummaryContentEl","typeSumarryFooterEl","footerHeight","moveToOption","fromOption","toOption","focus","displayChooser","sectionid","anchors","index","anchor","href","on","typeSummaryEl","target","closest","setTimeout","removeClass","document","window","optionOuterWidth","outerWidth","wrapperWidth","rowOptions","Math","floor","totalOptions","totalRowsCount","indexRow","ceil","keyCode","nextIndex","prevIndex","lastOptionIndex","actionElements","stopPropagation","next","nextAction","prev","prevAction","optionElement","hasClass","show","setupChooserDialogue","body","header","config"],"mappings":"AA2BAA,OAAM,kCACF,CACI,UADJ,CAEI,QAFJ,CAGI,aAHJ,CAII,8BAJJ,CAKI,2BALJ,CADE,CAQF,SACIC,CADJ,CAEIC,CAFJ,CAGIC,CAHJ,CAIIC,CAJJ,CAKIC,CALJ,CAME,IAGEC,CAAAA,CAAK,CAAG,IAHV,CASEC,CAAS,CAAG,IATd,CAWEC,CAAO,CAAG,IAXZ,CAcEC,CAAY,CAAG,EAdjB,CAgBEC,CAAW,CAAG,IAhBhB,CAiBEC,CAAa,CAAG,IAjBlB,CAkBEC,CAAc,CAAG,IAlBnB,CAuBEC,CAAK,CAAG,CASRC,SAAS,CAAE,GATH,CAkBRC,UAAU,CAAE,GAlBJ,CA2BRC,SAAS,CAAE,GA3BH,CAoCRC,gBAAgB,CAAE,CACdC,SAAS,CAAEjB,CAAC,CAACkB,IAAF,CAAOC,QADJ,CAEdC,KAAK,CAAE,OAFO,CApCV,CAvBV,CA+EEC,CAAkB,CAAG,UAAW,CAEhC,GAAIC,CAAAA,CAAJ,CACA,MAAOd,CAAY,CAACe,MAApB,CAA4B,CACxBD,CAAS,CAAGd,CAAY,CAACgB,KAAb,EAAZ,CACAvB,CAAC,CAACqB,CAAD,CAAD,CAAaG,GAAb,EACH,CACJ,CAtFC,CAwFEC,CAAI,CAAG,UAAW,CAElBL,CAAkB,GAClBf,CAAS,CAACmB,GAAV,GACApB,CAAK,CAACqB,IAAN,EACH,CA7FC,CA+FEC,CAAW,CAAG,SAASC,CAAT,CAAY,CAE1BA,CAAC,CAACC,cAAF,GACAH,CAAI,EACP,CAnGC,CAsHEI,CAAc,CAAG,SAASC,CAAT,CAAe,CAChC,GACIC,CAAAA,CAAO,CAAG,EADd,CAGAA,CAAO,CAACC,IAAR,CAAa,uCAAOC,WAAP,EAAb,EACA,GAAIH,CAAJ,CAAU,CAEN,OAAKI,CAAAA,CAAL,GAAYJ,CAAAA,CAAZ,CAAkB,CACdC,CAAO,CAACC,IAAR,CAAa,CAAC,wCAAeE,CAAhB,EAAqBD,WAArB,EAAb,CACH,CACJ,CAED,MAAOF,CAAAA,CACV,CAnIC,CAqIEI,CAAc,CAAG,UAAW,CAC5B,GAAI/B,CAAJ,CAAW,CACP,MACH,CAGDJ,CAAC,CAAC,MAAD,CAAD,CAAUoC,QAAV,CAAmB,WAAnB,EAEA,GAAIC,CAAAA,CAAJ,CACIC,CAAM,CAAG,CACLC,WAAW,CAAE/B,CAAW,CAACgC,IAAZ,EADR,CAELC,aAAa,CAAEhC,CAAa,CAAC+B,IAAd,EAFV,CAGLE,KAAK,CAAE,OAHF,CAILC,SAAS,GAJJ,CAKLC,OAAO,GALF,CAMLC,MAAM,CAAE,GANH,CAOLC,KAAK,GAPA,CAQLC,IAAI,GARC,CASLhC,gBAAgB,CAAEJ,CAAK,CAACI,gBATnB,CAULiC,8BAA8B,GAVzB,CAWLC,MAAM,GAXD,CAYLC,YAAY,CAAErB,CAAc,EAZvB,CADb,CAiBA,IAAKQ,CAAL,GAAiB3B,CAAAA,CAAjB,CAAiC,CAC/B4B,CAAM,CAACD,CAAD,CAAN,CAAmB3B,CAAc,CAAC2B,CAAD,CAClC,CAGDjC,CAAK,CAAG,GAAI+C,CAAAA,CAAC,CAACC,IAAF,CAAOC,QAAX,CAAoBf,CAApB,CAAR,CAGA9B,CAAW,CAAC8C,MAAZ,GACA7C,CAAa,CAAC6C,MAAd,GAGAlD,CAAK,CAACqB,IAAN,GACArB,CAAK,CAAC6C,MAAN,GAGA5C,CAAS,CAAGL,CAAC,CAACI,CAAK,CAACmD,GAAN,CAAU,aAAV,EAAyBC,GAAzB,CAA6B,sBAA7B,EAAqDC,UAArD,EAAD,CAAb,CACAnD,CAAO,CAAGD,CAAS,CAACqD,IAAV,CAAe,SAAf,CAAV,CAEA,GAAIC,CAAAA,CAAW,CAAGrD,CAAO,CAAC,CAAD,CAAzB,CACAN,CAAC,CAAC2D,CAAD,CAAD,CAAeC,IAAf,CAAoB,UAApB,CAAgC,CAAhC,EAEA,GAAIC,CAAAA,CAAa,CAAGxD,CAAS,CAACqD,IAAV,CAAe,gBAAf,CAApB,CACAG,CAAa,CAACC,IAAd,CAAmB,SAASC,CAAT,CAAcC,CAAd,CAA4B,CAC3ChE,CAAC,CAACgE,CAAD,CAAD,CAAgBJ,IAAhB,CAAqB,UAArB,CAAiC,CAAC,CAAlC,CACH,CAFD,EAKAxD,CAAK,CAACmD,GAAN,CAAU,aAAV,EAAyBnB,QAAzB,CAAkC,oBAAlC,CACH,CA3LC,CAsME6B,CAAc,CAAG,SAASZ,CAAT,CAAmB,CACpC,GAAIa,CAAAA,CAAE,CAAG9D,CAAK,CAACmD,GAAN,CAAU,aAAV,CAAT,CACIY,CAAS,CAAGD,CAAE,CAACX,GAAH,CAAO,WAAP,CADhB,CAEIa,CAFJ,CAEeC,CAFf,CAIA,GAAIjE,CAAK,CAACkE,sBAAN,EAAJ,CAAoC,CAEhC,MACH,CAIDF,CAAS,CAAGzD,CAAK,CAACG,SAAlB,CACA,GAAIqD,CAAS,EAAIC,CAAjB,CAA4B,CAExB,GAAID,CAAS,EAAIxD,CAAK,CAACC,SAAvB,CAAkC,CAC9BwD,CAAS,CAAGzD,CAAK,CAACC,SACrB,CAFD,IAEO,CACHwD,CAAS,CAAGD,CACf,CACJ,CAID,GAAIC,CAAS,CAAGzD,CAAK,CAACC,SAAtB,CAAiC,CAE7B,GAAIR,CAAK,CAACmE,UAAN,EAAoB,CAACnE,CAAK,CAACmE,UAAN,CAAiBC,QAAjB,EAAzB,CAAsD,CAClDpE,CAAK,CAACmE,UAAN,CAAiBE,gBAAjB,IACH,CACJ,CALD,IAKO,CAEH,GAAIrE,CAAK,CAACmE,UAAN,EAAoBnE,CAAK,CAACmE,UAAN,CAAiBC,QAAjB,EAAxB,CAAqD,CACjDpE,CAAK,CAACmE,UAAN,CAAiBG,iBAAjB,EACH,CACJ,CAIDL,CAAW,CAAGD,CAAd,CACAA,CAAS,CAAGA,CAAS,IAArB,CACApE,CAAC,CAACqD,CAAD,CAAD,CAAYsB,GAAZ,CAAgB,WAAhB,CAA6BP,CAAS,CAAG,IAAzC,EAEA,GAAIQ,CAAAA,CAAc,CAAGV,CAAE,CAACW,QAAH,CAAY,QAAZ,CAArB,CACA,GAAID,CAAc,CAACE,KAAf,CAAqB,OAArB,CAAJ,CAAmC,CAC/BF,CAAc,CAAGA,CAAc,CAACG,OAAf,CAAuB,KAAvB,CAA8B,EAA9B,CACpB,CAFD,IAEO,CACHH,CAAc,CAAGP,CACpB,CAED,GAAIO,CAAc,CAAGjE,CAAK,CAACE,UAA3B,CAAuC,CACnC+D,CAAc,CAAGjE,CAAK,CAACE,UAAvB,CACAb,CAAC,CAACqD,CAAD,CAAD,CAAYsB,GAAZ,CAAgB,QAAhB,CAA0BC,CAAc,CAAG,IAA3C,CACH,CAEDxE,CAAK,CAAC6D,cAAN,EACH,CA7PC,CA8QEe,CAAsB,CAAG,SAASC,CAAT,CAAe9D,CAAf,CAAsB,CAzP5B,IA0PnB,CAAiByC,IAAjB,CAAsB,CAClBzC,KAAK,CAAEA,CADW,CAElB8D,IAAI,CAAEA,CAFY,CAAtB,CAIH,CAnRC,CAqREC,CAAc,CAAG,SAASvD,CAAT,CAAY,CAI7BqD,CAAsB,CAACrD,CAAC,CAACsD,IAAH,CAAStD,CAAC,CAACR,KAAX,CAAtB,CACAlB,CAAM,CAACkF,OAAP,CAAejF,CAAqB,CAACkF,eAArC,CAAsDzD,CAAtD,CACH,CA3RC,CAmTE0D,CAAe,CAAG,SAASC,CAAT,CAA6B,IAE3CC,CAAAA,CAAQ,CAAGvF,CAAC,CAAC,aAAD,CAAD,CAAiBwF,SAAjB,EAFgC,CAI3CC,CAAM,CAAGzF,CAAC,CAAC,aAAD,CAAD,CAAiB0F,WAAjB,EAJkC,CAM/C1F,CAAC,CAAC,aAAD,CAAD,CAAiBoC,QAAjB,CAA0B,UAA1B,EAEAuD,CAA+B,CAACL,CAAD,CAAqBC,CAArB,CAA+BE,CAA/B,CAA/B,CAEA,GAAIG,CAAAA,CAAyB,CAAGN,CAAkB,CAAC5B,IAAnB,CAAwB,UAAxB,CAAhC,CAEA,GAA4C,CAAxC,CAAAkC,CAAyB,CAACJ,SAA1B,EAAJ,CAA+C,CAC3CI,CAAyB,CAACJ,SAA1B,CAAoC,CAApC,CACH,CAEDF,CAAkB,CAAClD,QAAnB,CAA4B,MAA5B,EAhB+C,GAiB3CyD,CAAAA,CAAY,CAAGP,CAAkB,CAAC5B,IAAnB,CAAwB,mBAAxB,CAjB4B,CAkB3CoC,CAAS,CAAGR,CAAkB,CAAC5B,IAAnB,CAAwB,YAAxB,CAlB+B,CAoB/C1D,CAAC,CAAC6F,CAAD,CAAD,CAAgBjC,IAAhB,CAAqB,UAArB,CAAiC,CAAjC,EACA5D,CAAC,CAAC8F,CAAD,CAAD,CAAalC,IAAb,CAAkB,UAAlB,CAA8B,CAA9B,EAEAzD,CAAS,CAAC4F,SAAV,CAAoBT,CAApB,CACH,CA3UC,CA6UEK,CAA+B,CAAG,SAASK,CAAT,CAAkBT,CAAlB,CAA4BE,CAA5B,CAAoC,IAClEQ,CAAAA,CAAoB,CAAGD,CAAO,CAACtC,IAAR,CAAa,UAAb,CAD2C,CAElEwC,CAAmB,CAAGF,CAAO,CAACtC,IAAR,CAAa,gBAAb,CAF4C,CAGlEyC,CAAY,CAAGD,CAAmB,CAACT,MAApB,EAHmD,CAMtEQ,CAAoB,CAACtB,GAArB,CAAyB,CAAC,OAFNc,CAAM,CAAGU,CAEQ,CAAgB,IAA5B,CAAzB,EAEAH,CAAO,CAACrB,GAAR,CAAY,CAAC,IAAQY,CAAQ,CAAG,IAApB,CAA0B,OAAWE,CAAM,CAAG,IAA9C,CAAZ,CACH,CAtVC,CAwVEW,CAAY,CAAG,SAASC,CAAT,CAAqBC,CAArB,CAA+B,CAC9CtG,CAAC,CAACsG,CAAD,CAAD,CAAY1C,IAAZ,CAAiB,UAAjB,CAA6B,CAA7B,EACA5D,CAAC,CAACsG,CAAD,CAAD,CAAYC,KAAZ,GACAvG,CAAC,CAACqG,CAAD,CAAD,CAAczC,IAAd,CAAmB,UAAnB,CAA+B,CAAC,CAAhC,CACH,CA5VC,CAoWE4C,CAAc,CAAG,SAAS7E,CAAT,CAAY8E,CAAZ,CAAuB,CACxC,GAAIvC,CAAAA,CAAJ,CAAQb,CAAR,CAAkBhC,CAAlB,CACAc,CAAc,GAGdR,CAAC,CAACC,cAAF,GAEAsC,CAAE,CAAG9D,CAAK,CAACmD,GAAN,CAAU,aAAV,CAAL,CACAF,CAAQ,CAAGhD,CAAS,CAACqD,IAAV,CAAe,aAAf,CAAX,CAGA,GAAIgD,CAAAA,CAAO,CAAGrD,CAAQ,CAACK,IAAT,CAAc,oEAAd,CAAd,CACAgD,CAAO,CAAC5C,IAAR,CAAa,SAAS6C,CAAT,CAAgBC,CAAhB,CAAwB,CACjCA,CAAM,CAACC,IAAP,EAAe,YAAcJ,CAChC,CAFD,EAIApF,CAAS,CAAGrB,CAAC,CAAC,qBAAD,CAAD,CAAyB8G,EAAzB,CAA4B,OAA5B,CAAqC,SAASnF,CAAT,CAAY,CACzD,GAAIoF,CAAAA,CAAa,CAAG/G,CAAC,CAAC2B,CAAC,CAACqF,MAAH,CAAD,CAAYC,OAAZ,CAAoB,OAApB,EAA6BvD,IAA7B,CAAkC,cAAlC,CAApB,CACA2B,CAAe,CAAC0B,CAAD,CAClB,CAHW,CAAZ,CAIAxG,CAAY,CAACyB,IAAb,CAAkBX,CAAlB,EAEAA,CAAS,CAAGrB,CAAC,CAAC,mBAAD,CAAD,CAAuB8G,EAAvB,CAA0B,OAA1B,CAAmC,SAASnF,CAAT,CAAY,CACvDuF,UAAU,CAAC,UAAW,CAClB,GAAIH,CAAAA,CAAa,CAAG/G,CAAC,CAAC2B,CAAC,CAACqF,MAAH,CAAD,CAAYC,OAAZ,CAAoB,OAApB,EAA6BvD,IAA7B,CAAkC,cAAlC,CAApB,CACAqD,CAAa,CAACI,WAAd,CAA0B,MAA1B,EAEAnH,CAAC,CAAC,aAAD,CAAD,CAAiBmH,WAAjB,CAA6B,UAA7B,CACH,CALS,CAKP,GALO,CAMb,CAPW,CAAZ,CAQA5G,CAAY,CAACyB,IAAb,CAAkBX,CAAlB,EAGAA,CAAS,CAAGrB,CAAC,CAACoH,QAAD,CAAD,CAAYN,EAAZ,CAAe,mBAAf,CAAoC,UAAW,CACvD7C,CAAc,CAACZ,CAAD,CACjB,CAFW,CAAZ,CAGA9C,CAAY,CAACyB,IAAb,CAAkBX,CAAlB,EAGAA,CAAS,CAAGrB,CAAC,CAACqH,MAAD,CAAD,CAAUP,EAAV,CAAa,QAAb,CAAuB,UAAW,CAC1C7C,CAAc,CAACZ,CAAD,CACjB,CAFW,CAAZ,CAGA9C,CAAY,CAACyB,IAAb,CAAkBX,CAAlB,EAQAA,CAAS,CAAGrB,CAAC,CAAC,SAAD,CAAD,CAAa8G,EAAb,CAAgB,SAAhB,CAA2B,SAASnF,CAAT,CAAY,IAC3CgF,CAAAA,CAAK,CAAG3G,CAAC,CAAC,IAAD,CAAD,CAAQ2G,KAAR,EADmC,CAE3CW,CAAgB,CAAGtH,CAAC,CAAC,SAAD,CAAD,CAAauH,UAAb,EAFwB,CAG3CC,CAAY,CAAGxH,CAAC,CAAC,aAAD,CAAD,CAAiB0C,KAAjB,EAH4B,CAI3C+E,CAAU,CAAGC,IAAI,CAACC,KAAL,CAAWH,CAAY,CAAGF,CAA1B,CAJ8B,CAK3CM,CAAY,CAAGtH,CAAO,CAACgB,MALoB,CAM3CuG,CAAc,CAAGH,IAAI,CAACC,KAAL,CAAWrH,CAAO,CAACgB,MAAR,CAAiBmG,CAA5B,CAN0B,CAO3CK,CAAQ,CAAGJ,IAAI,CAACK,IAAL,CAAU,CAACpB,CAAK,CAAG,CAAT,EAAcc,CAAxB,CAPgC,CAU/C,GAAkB,EAAd,GAAA9F,CAAC,CAACqG,OAAN,CAAsB,CAClB,GAAIC,CAAAA,CAAS,CAAGtB,CAAK,CAAG,CAAxB,CACA,GAAkC,WAA9B,QAAOrG,CAAAA,CAAO,CAAC2H,CAAD,CAAlB,CAA+C,CAC3C,MACH,CACD7B,CAAY,CAAC9F,CAAO,CAACqG,CAAD,CAAR,CAAiBrG,CAAO,CAAC2H,CAAD,CAAxB,CACf,CAGD,GAAkB,EAAd,GAAAtG,CAAC,CAACqG,OAAN,CAAsB,CAClB,GAAIE,CAAAA,CAAS,CAAGvB,CAAK,CAAG,CAAxB,CACA,GAAkC,WAA9B,QAAOrG,CAAAA,CAAO,CAAC4H,CAAD,CAAlB,CAA+C,CAC3C,MACH,CACD9B,CAAY,CAAC9F,CAAO,CAACqG,CAAD,CAAR,CAAiBrG,CAAO,CAAC4H,CAAD,CAAxB,CACf,CAGD,GAAkB,EAAd,GAAAvG,CAAC,CAACqG,OAAN,CAAsB,CAElB,GAAIF,CAAQ,EAAID,CAAhB,CAAgC,CAC5B,MACH,CACD,GAAII,CAAAA,CAAS,CAAGtB,CAAK,CAAGc,CAAxB,CACA,GAAkC,WAA9B,QAAOnH,CAAAA,CAAO,CAAC2H,CAAD,CAAlB,CAA+C,CAC3CA,CAAS,CAAGL,CAAY,CAAG,CAC9B,CACDxB,CAAY,CAAC9F,CAAO,CAACqG,CAAD,CAAR,CAAiBrG,CAAO,CAAC2H,CAAD,CAAxB,CACf,CAGD,GAAkB,EAAd,GAAAtG,CAAC,CAACqG,OAAN,CAAsB,CAElB,GAAiB,CAAb,GAAAF,CAAJ,CAAoB,CAChB,MACH,CACD,GAAII,CAAAA,CAAS,CAAGvB,CAAK,CAAGc,CAAxB,CACA,GAAkC,WAA9B,QAAOnH,CAAAA,CAAO,CAAC4H,CAAD,CAAlB,CAA+C,CAC3CA,CAAS,CAAG,CACf,CACD9B,CAAY,CAAC9F,CAAO,CAACqG,CAAD,CAAR,CAAiBrG,CAAO,CAAC4H,CAAD,CAAxB,CACf,CAGD,GAAkB,EAAd,GAAAvG,CAAC,CAACqG,OAAN,CAAsB,CAClB,GAAIG,CAAAA,CAAe,CAAGP,CAAY,CAAG,CAArC,CACA,GAAIjB,CAAK,GAAKwB,CAAd,CAA+B,CAC3B,MACH,CACD/B,CAAY,CAAC9F,CAAO,CAACqG,CAAD,CAAR,CAAiBrG,CAAO,CAAC6H,CAAD,CAAxB,CACf,CAGD,GAAkB,EAAd,GAAAxG,CAAC,CAACqG,OAAN,CAAsB,CAElB,GAAIrB,CAAK,IAAT,CAAgC,CAC5B,MACH,CACDP,CAAY,CAAC9F,CAAO,CAACqG,CAAD,CAAR,CAAiBrG,CAAO,GAAxB,CACf,CAED,GAAkB,EAAd,GAAAqB,CAAC,CAACqG,OAAF,EAAiC,EAAb,EAAArG,CAAC,CAACqG,OAA1B,CAAyC,CACrC,GAAII,CAAAA,CAAc,CAAGpI,CAAC,CAAC,IAAD,CAAD,CAAQ0D,IAAR,CAAa,gBAAb,CAArB,CAUC1D,CAAC,CAACoI,CAAc,CAAC,CAAD,CAAf,CAAD,CAAqBxE,IAArB,CAA0B,UAA1B,CAAsC,CAAtC,EACA5D,CAAC,CAACoI,CAAc,CAAC,CAAD,CAAf,CAAD,CAAqB7B,KAArB,GACAvG,CAAC,CAAC,IAAD,CAAD,CAAQ4D,IAAR,CAAa,UAAb,CAAyB,CAAC,CAA1B,CACJ,CACJ,CAtFW,CAAZ,CAuFArD,CAAY,CAACyB,IAAb,CAAkBX,CAAlB,EAEAA,CAAS,CAAGrB,CAAC,CAAC,gBAAD,CAAD,CAAoB8G,EAApB,CAAuB,SAAvB,CAAkC,SAASnF,CAAT,CAAY,CACrDA,CAAC,CAACC,cAAF,GACAD,CAAC,CAAC0G,eAAF,GAFqD,GAIlDD,CAAAA,CAAc,CAAGpI,CAAC,CAAC,IAAD,CAAD,CAAQiH,OAAR,CAAgB,OAAhB,EAAyBvD,IAAzB,CAA8B,gBAA9B,CAJiC,CAKlDiD,CAAK,CAAG3G,CAAC,CAACoI,CAAD,CAAD,CAAkBzB,KAAlB,CAAwB,IAAxB,CAL0C,CAQtD,GAAkB,EAAd,GAAAhF,CAAC,CAACqG,OAAF,EAAkC,EAAd,GAAArG,CAAC,CAACqG,OAA1B,CAA0C,CACtC,GAAIM,CAAAA,CAAI,CAAG3B,CAAK,CAAG,CAAnB,CACA,GAAoC,WAAhC,QAAOyB,CAAAA,CAAc,CAACE,CAAD,CAAzB,CAAiD,CAC7C,MACH,CACD,GAAIC,CAAAA,CAAU,CAAGH,CAAc,CAACE,CAAD,CAA/B,CACAtI,CAAC,CAACuI,CAAD,CAAD,CAAc3E,IAAd,CAAmB,UAAnB,CAA+B,CAA/B,EACA5D,CAAC,CAACuI,CAAD,CAAD,CAAchC,KAAd,GACAvG,CAAC,CAAC,IAAD,CAAD,CAAQ4D,IAAR,CAAa,UAAb,CAAyB,CAAC,CAA1B,CACH,CAGD,GAAkB,EAAd,GAAAjC,CAAC,CAACqG,OAAF,EAAkC,EAAd,GAAArG,CAAC,CAACqG,OAA1B,CAA0C,CACtC,GAAIQ,CAAAA,CAAI,CAAG7B,CAAK,CAAG,CAAnB,CACA,GAAoC,WAAhC,QAAOyB,CAAAA,CAAc,CAACI,CAAD,CAAzB,CAAiD,CAC7C,MACH,CACD,GAAIC,CAAAA,CAAU,CAAGL,CAAc,CAACI,CAAD,CAA/B,CACAxI,CAAC,CAACyI,CAAD,CAAD,CAAc7E,IAAd,CAAmB,UAAnB,CAA+B,CAA/B,EACA5D,CAAC,CAACyI,CAAD,CAAD,CAAclC,KAAd,GACAvG,CAAC,CAAC,IAAD,CAAD,CAAQ4D,IAAR,CAAa,UAAb,CAAyB,CAAC,CAA1B,CACH,CAED,GAAkB,EAAd,GAAAjC,CAAC,CAACqG,OAAN,CAAsB,CAClB,GAAIU,CAAAA,CAAa,CAAG1I,CAAC,CAAC,IAAD,CAAD,CAAQiH,OAAR,CAAgB,SAAhB,CAApB,CACAjH,CAAC,CAAC0I,CAAD,CAAD,CAAiB9E,IAAjB,CAAsB,UAAtB,CAAkC,CAAlC,EACA5D,CAAC,CAAC0I,CAAD,CAAD,CAAiBnC,KAAjB,GACAvG,CAAC,CAAC,IAAD,CAAD,CAAQ4D,IAAR,CAAa,UAAb,CAAyB,CAAC,CAA1B,CACH,CAED,GAAkB,EAAd,GAAAjC,CAAC,CAACqG,OAAN,CAAsB,CAClB,GAAIhI,CAAC,CAAC,IAAD,CAAD,CAAQ2I,QAAR,CAAiB,MAAjB,CAAJ,CAA8B,CAC1B,GAAI5B,CAAAA,CAAa,CAAG/G,CAAC,CAAC,IAAD,CAAD,CAAQiH,OAAR,CAAgB,OAAhB,EAAyBvD,IAAzB,CAA8B,cAA9B,CAApB,CACA2B,CAAe,CAAC0B,CAAD,CAClB,CAEJ,CACJ,CA7CW,CAAZ,CA8CAxG,CAAY,CAACyB,IAAb,CAAkBX,CAAlB,EAGAA,CAAS,CAAG6C,CAAE,CAACV,GAAH,CAAO,oBAAP,EAA6BsD,EAA7B,CAAgC,OAAhC,CAAyC,SAASnF,CAAT,CAAY,CAC7DD,CAAW,CAACC,CAAD,CACd,CAFW,CAAZ,CAGApB,CAAY,CAACyB,IAAb,CAAkBX,CAAlB,EAOAjB,CAAK,CAACwI,IAAN,CAAWjH,CAAX,EAGAsC,CAAc,CAACZ,CAAD,CAAd,CAGAhD,CAAS,CAACqD,IAAV,CAAe,2BAAf,EAA4C6C,KAA5C,EACH,CAjjBC,CAmjBF,MAA0D,CAOtDsC,oBAAoB,CAzfG,QAAvBA,CAAAA,oBAAuB,CAASC,CAAT,CAAeC,CAAf,CAAuBC,CAAvB,CAA+B,CACtDxI,CAAW,CAAGsI,CAAd,CACArI,CAAa,CAAGsI,CAAhB,CACArI,CAAc,CAAGsI,CACpB,CA8eyD,CAqBtDxC,cAAc,CAAEA,CArBsC,CAsBtDxB,sBAAsB,CAAEA,CAtB8B,CAwB7D,CAzlBK,CAAN","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * A system for displaying notifications to users from the session.\n *\n * Wrapper for the YUI M.core.notification class. Allows us to\n * use the YUI version in AMD code until it is replaced.\n *\n * @module     core/activity_chooser_dialogue\n * @package    core\n * @copyright  2019 Mihail Geshoski <mihail@moodle.com>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n * @since      3.7\n */\ndefine(\n    [\n        'core/yui',\n        'jquery',\n        'core/pubsub',\n        'core/activity_chooser_events',\n        'core/local/aria/focuslock'\n    ],\n    function(\n        Y,\n        $,\n        PubSub,\n        ActivityChooserEvents,\n        FocusLock\n    ) {\n\n     // The panel widget\n    var panel = null;\n\n    // The submit button - we disable this until an element is set\n    var submitbutton = null;\n\n    // The chooserdialogue container\n    var container = null;\n\n    var options = null;\n\n    // Any event listeners we may need to cancel later\n    var listenevents = [];\n\n    var bodycontent = null;\n    var headercontent = null;\n    var instanceconfig = null;\n\n    // The hidden field storing the disabled element values for submission.\n    var hiddenRadioValue = null;\n\n    var ATTRS = {\n        /**\n         * The minimum height (in pixels) before resizing is prevented and scroll\n         * locking disabled.\n         *\n         * @attribute minheight\n         * @type Number\n         * @default 300\n         */\n        minheight: 300,\n\n        /**\n         * The base height??\n         *\n         * @attribute baseheight\n         * @type Number\n         * @default 400\n         */\n        baseheight: 400,\n\n        /**\n         * The maximum height (in pixels) at which we stop resizing.\n         *\n         * @attribute maxheight\n         * @type Number\n         * @default 300\n         */\n        maxheight: 660,\n\n        /**\n         * The title of the close button.\n         *\n         * @attribute closeButtonTitle\n         * @type String\n         * @default 'Close'\n         */\n        closeButtonTitle: {\n            validator: Y.Lang.isString,\n            value: 'Close'\n        }\n    };\n\n    var setupChooserDialogue = function(body, header, config) {\n        bodycontent = body;\n        headercontent = header;\n        instanceconfig = config;\n    };\n\n    /**\n     * Cancel any listen events in the listenevents queue\n     *\n     * Several locations add event handlers which should only be called before the form is submitted. This provides\n     * a way of cancelling those events.\n     *\n     * @method cancel_listenevents\n     */\n    var cancelListenevents = function() {\n        // Detach all listen events to prevent duplicate triggers\n        var thisevent;\n        while (listenevents.length) {\n            thisevent = listenevents.shift();\n            $(thisevent).off();\n        }\n    };\n\n    var hide = function() {\n        // Cancel all listen events\n        cancelListenevents();\n        container.off();\n        panel.hide();\n    };\n\n    var cancelPopup = function(e) {\n        // Prevent normal form submission before hiding\n        e.preventDefault();\n        hide();\n    };\n\n      /**\n     * Return an array of class names prefixed with 'modchooserdialogue-' and\n     * the name of the type of dialogue.\n     *\n     * Note: Class name are converted to lower-case.\n     *\n     * If an array of arguments is supplied, each of these is prefixed and\n     * lower-cased also.\n     *\n     * If no arguments are supplied, then the prefix is returned on it's\n     * own.\n     *\n     * @method _getClassNames\n     * @param {Array} [args] Any additional names to prefix and lower-case.\n     * @return {Array}\n     * @private\n     */\n    var _getClassNames = function(args) {\n        var prefix = 'modchooserdialogue-course-modchooser',\n            results = [];\n\n        results.push(prefix.toLowerCase());\n        if (args) {\n            var arg;\n            for (arg in args) {\n                results.push((prefix + '-' + arg).toLowerCase());\n            }\n        }\n\n        return results;\n    };\n\n    var prepareChooser = function() {\n        if (panel) {\n            return;\n        }\n\n        // Ensure that we're showing the JS version of the chooser.\n        $('body').addClass('jschooser');\n        // Set Default options.\n        var paramkey,\n            params = {\n                bodyContent: bodycontent.html(),\n                headerContent: headercontent.html(),\n                width: '540px',\n                draggable: true,\n                visible: false, // Hide by default\n                zindex: 100, // Display in front of other items\n                modal: true, // This dialogue should be modal.\n                shim: true,\n                closeButtonTitle: ATTRS.closeButtonTitle,\n                focusOnPreviousTargetAfterHide: true,\n                render: false,\n                extraClasses: _getClassNames()\n            };\n\n        // Override with additional options.\n        for (paramkey in instanceconfig) {\n          params[paramkey] = instanceconfig[paramkey];\n        }\n\n        // Create the panel\n        panel = new M.core.dialogue(params);\n\n        // Remove the template for the chooser.\n        bodycontent.remove();\n        headercontent.remove();\n\n        // Hide and then render the panel.\n        panel.hide();\n        panel.render();\n\n        // Set useful links.\n        container = $(panel.get('boundingBox').one('.modchoosercontainer').getDOMNode());\n        options = container.find('.option');\n        // Get the first option and set the tabindex.\n        var firstOption = options[0];\n        $(firstOption).attr(\"tabindex\", 0);\n\n        var moreinfolinks = container.find('.helplinkpopup');\n        moreinfolinks.each(function(key, moreinfolink) {\n            $(moreinfolink).attr('tabindex', -1);\n        });\n\n        // Add the chooserdialogue class to the container for styling.\n        panel.get('boundingBox').addClass('modchooserdialogue');\n    };\n\n    /**\n      * Calculate the optimum height of the chooser dialogue\n      *\n      * This tries to set a sensible maximum and minimum to ensure that some options are always shown, and preferably\n      * all, whilst fitting the box within the current viewport.\n      *\n      * @method center_dialogue\n      * @param Node {dialogue} Y.Node The dialogue\n      */\n    var centerDialogue = function(dialogue) {\n        var bb = panel.get('boundingBox'),\n            winheight = bb.get('winHeight'),\n            newheight, totalheight;\n\n        if (panel.shouldResizeFullscreen()) {\n            // No custom sizing required for a fullscreen dialog.\n            return;\n        }\n\n        // Try and set a sensible max-height -- this must be done before setting the top\n        // Set a default height of 640px\n        newheight = ATTRS.maxheight;\n        if (winheight <= newheight) {\n            // Deal with smaller window sizes\n            if (winheight <= ATTRS.minheight) {\n                newheight = ATTRS.minheight;\n            } else {\n                newheight = winheight;\n            }\n        }\n\n        // If the dialogue is larger than a reasonable minimum height, we\n        // disable the page scrollbars.\n        if (newheight > ATTRS.minheight) {\n            // Disable the page scrollbars.\n            if (panel.lockScroll && !panel.lockScroll.isActive()) {\n                panel.lockScroll.enableScrollLock(true);\n            }\n        } else {\n            // Re-enable the page scrollbars.\n            if (panel.lockScroll && panel.lockScroll.isActive()) {\n                panel.lockScroll.disableScrollLock();\n            }\n        }\n\n        // Take off 15px top and bottom for borders, plus 40px each for the title and button area before setting the\n        // new max-height.\n        totalheight = newheight;\n        newheight = newheight - (15 + 15 + 40 + 40);\n        $(dialogue).css('maxHeight', newheight + 'px');\n\n        var dialogueheight = bb.getStyle('height');\n        if (dialogueheight.match(/.*px$/)) {\n            dialogueheight = dialogueheight.replace(/px$/, '');\n        } else {\n            dialogueheight = totalheight;\n        }\n\n        if (dialogueheight < ATTRS.baseheight) {\n            dialogueheight = ATTRS.baseheight;\n            $(dialogue).css('height', dialogueheight + 'px');\n        }\n\n        panel.centerDialogue();\n    };\n\n    var handleKeyPress = function(e) {\n        if (e.keyCode === 27) {\n            cancelPopup(e);\n        }\n\n        if (e.keyCode === 39) {\n            var focusedElement = $(\":focus\");\n            console.log(focusedElement);\n            console.log(options);\n            // if ($(\":focus\").hasClass('.option')) {\n            //\n            // }\n        }\n    };\n\n    var updateHiddenRadioValue = function(name, value) {\n        hiddenRadioValue.attr({\n            value: value,\n            name: name\n        });\n    };\n\n    var optionSelected = function(e) {\n        // Set a hidden input field with the value and name of the radio button.  When we submit the form, we\n        // disable the radios to prevent duplicate submission. This has the result however that the value is never\n        // submitted so we set this value to a hidden field instead.\n        updateHiddenRadioValue(e.name, e.value);\n        PubSub.publish(ActivityChooserEvents.OPTION_SELECTED, e);\n    };\n\n    var checkOptions = function() {\n        // Check which options are set, and change the parent class\n        // to show/hide help as required.\n        options.each(function(key, option) {\n            var optiondiv = $(option).parent().parent();\n            if ($(this).is(':checked')) {\n                $(optiondiv).addClass('selected');\n\n                // Trigger any events for this option.\n                optionSelected(option);\n\n                // Ensure that the form may be submitted.\n                submitbutton.removeAttr('disabled');\n\n                // Ensure that the radio remains focus so that keyboard navigation is still possible.\n                $(option).focus();\n            } else {\n                optiondiv.removeClass('selected');\n            }\n        }, this);\n    };\n\n    var openTypeSummary = function(typeSummaryElement) {\n        // Get the current scroll position of the .alloption element.\n        var position = $('.alloptions').scrollTop();\n        // Get the height of the .alloption element.\n        var height = $('.alloptions').outerHeight();\n        // Disable the scroll of .alloptions.\n        $('.alloptions').addClass('noscroll');\n\n        setTypeSummaryPositionAndHeight(typeSummaryElement, position, height);\n\n        var typeSummaryContentElement = typeSummaryElement.find('.content');\n        // Set the scroll of the type summary content element to top.\n        if (typeSummaryContentElement.scrollTop() > 0) {\n            typeSummaryContentElement.scrollTop(0);\n        }\n        // Show the particular summary overlay.\n        typeSummaryElement.addClass('open');\n        var cancelAction = typeSummaryElement.find('.closetypesummary');\n        var addAction = typeSummaryElement.find('.addbutton');\n\n        $(cancelAction).attr('tabindex', 0);\n        $(addAction).attr('tabindex', 0);\n\n        FocusLock.trapFocus(typeSummaryElement);\n    };\n\n    var setTypeSummaryPositionAndHeight = function(element, position, height) {\n        var typeSummaryContentEl = element.find('.content');\n        var typeSumarryFooterEl = element.find('.action-footer');\n        var footerHeight = typeSumarryFooterEl.height();\n        var contentHeight = height - footerHeight;\n\n        typeSummaryContentEl.css({'height' : contentHeight + 'px'});\n\n        element.css({'top' : position + 'px', 'height' : height + 'px'});\n    };\n\n    var moveToOption = function(fromOption, toOption) {\n        $(toOption).attr('tabindex', 0);\n        $(toOption).focus();\n        $(fromOption).attr('tabindex', -1);\n    };\n\n    /**\n      * Display the module chooser.\n      *\n      * @method display_chooser\n      * @param {EventFacade} e Triggering Event\n      */\n    var displayChooser = function(e, sectionid) {\n        var bb, dialogue, thisevent;\n        prepareChooser();\n\n        // Stop the default event actions before we proceed.\n        e.preventDefault();\n\n        bb = panel.get('boundingBox');\n        dialogue = container.find('.alloptions');\n\n        // Find all anchors used to add an activity and append the section param to the url.\n        var anchors = dialogue.find('.option .modicon a, .option .typesummary .action-footer .addbutton');\n        anchors.each(function(index, anchor) {\n            anchor.href += '&section=' + sectionid;\n        });\n\n        thisevent = $('.info.actionelement').on('click', function(e) {\n            var typeSummaryEl = $(e.target).closest('label').find('.typesummary');\n            openTypeSummary(typeSummaryEl);\n        });\n        listenevents.push(thisevent);\n\n        thisevent = $('.closetypesummary').on('click', function(e) {\n            setTimeout(function() {\n                var typeSummaryEl = $(e.target).closest('label').find('.typesummary');\n                typeSummaryEl.removeClass('open');\n\n                $('.alloptions').removeClass('noscroll');\n            }, 100);\n        });\n        listenevents.push(thisevent);\n\n        // This will detect a change in orientation and retrigger centering.\n        thisevent = $(document).on('orientationchange', function() {\n            centerDialogue(dialogue);\n        });\n        listenevents.push(thisevent);\n\n        // Detect window resizes (most browsers).\n        thisevent = $(window).on('resize', function() {\n            centerDialogue(dialogue);\n        });\n        listenevents.push(thisevent);\n\n        // thisevent = container.on('keyup', function() {\n        //     console.log(\"Herreee\");\n        //     //checkOptions();\n        // });\n        // listenevents.push(thisevent);\n\n        thisevent = $(\".option\").on('keydown', function(e) {\n            var index = $(this).index();\n            var optionOuterWidth = $('.option').outerWidth();\n            var wrapperWidth = $('.alloptions').width();\n            var rowOptions = Math.floor(wrapperWidth / optionOuterWidth);\n            var totalOptions = options.length;\n            var totalRowsCount = Math.floor(options.length / rowOptions);\n            var indexRow = Math.ceil((index + 1) / rowOptions);\n\n            // Right key.\n            if (e.keyCode === 39) {\n                var nextIndex = index + 1;\n                if (typeof options[nextIndex] === 'undefined') {\n                    return;\n                }\n                moveToOption(options[index], options[nextIndex]);\n            }\n\n            // Left key.\n            if (e.keyCode === 37) {\n                var prevIndex = index - 1;\n                if (typeof options[prevIndex] === 'undefined') {\n                    return;\n                }\n                moveToOption(options[index], options[prevIndex]);\n            }\n\n            // down key.\n            if (e.keyCode === 40) {\n                // If the focus is on an element from the last visual row.\n                if (indexRow == totalRowsCount) {\n                    return;\n                }\n                var nextIndex = index + rowOptions;\n                if (typeof options[nextIndex] === 'undefined') {\n                    nextIndex = totalOptions - 1;\n                }\n                moveToOption(options[index], options[nextIndex]);\n            }\n\n            // up key.\n            if (e.keyCode === 38) {\n                // if the focus is on an element from the first visual row.\n                if (indexRow === 1) {\n                    return;\n                }\n                var prevIndex = index - rowOptions;\n                if (typeof options[prevIndex] === 'undefined') {\n                    prevIndex = 0;\n                }\n                moveToOption(options[index], options[prevIndex]);\n            }\n\n            // end key.\n            if (e.keyCode === 35) {\n                var lastOptionIndex = totalOptions - 1;\n                if (index === lastOptionIndex) {\n                    return;\n                }\n                moveToOption(options[index], options[lastOptionIndex]);\n            }\n\n            // home key.\n            if (e.keyCode === 36) {\n                var firstOptionIndex = 0;\n                if (index === firstOptionIndex) {\n                    return;\n                }\n                moveToOption(options[index], options[firstOptionIndex]);\n            }\n\n            if (e.keyCode === 13 || e.keyCode == 32) {\n                var actionElements = $(this).find('.actionelement');\n                // optionactions.each(function(index, optionaction) {\n                //     $($(optionaction).children()[0]).attr({'tabindex' : 0, 'aria-hidden' : 'false'});\n                // });\n                // var modinfo = $(this).find('.info i');\n                // //$(this).attr('tabindex', -1);\n                // $(modanchor).attr('tabindex', 0);\n                // $(modinfo).attr('tabindex', 0);\n                // $(modinfo).attr('aria-hidden', 'false');\n                // $(modanchor).focus();\n                 $(actionElements[0]).attr('tabindex', 0);\n                 $(actionElements[0]).focus();\n                 $(this).attr('tabindex', -1);\n            }\n        });\n        listenevents.push(thisevent);\n\n        thisevent = $(\".actionelement\").on('keydown', function(e) {\n             e.preventDefault();\n             e.stopPropagation();\n\n            var actionElements = $(this).closest(\"label\").find(\".actionelement\");\n            var index = $(actionElements).index(this);\n\n            // down key.\n            if (e.keyCode === 40 || e.keyCode === 39) {\n                var next = index + 1;\n                if (typeof actionElements[next] === 'undefined') {\n                    return;\n                }\n                var nextAction = actionElements[next];\n                $(nextAction).attr('tabindex', 0);\n                $(nextAction).focus();\n                $(this).attr('tabindex', -1);\n            }\n\n            // up key.\n            if (e.keyCode === 38 || e.keyCode === 37) {\n                var prev = index - 1;\n                if (typeof actionElements[prev] === 'undefined') {\n                    return;\n                }\n                var prevAction = actionElements[prev];\n                $(prevAction).attr('tabindex', 0);\n                $(prevAction).focus();\n                $(this).attr('tabindex', -1);\n            }\n\n            if (e.keyCode === 27) {\n                var optionElement = $(this).closest('.option');\n                $(optionElement).attr('tabindex', 0);\n                $(optionElement).focus();\n                $(this).attr('tabindex', -1);\n            }\n\n            if (e.keyCode === 13) {\n                if ($(this).hasClass('info')) {\n                    var typeSummaryEl = $(this).closest('label').find('.typesummary');\n                    openTypeSummary(typeSummaryEl);\n                }\n                return;\n            }\n        });\n        listenevents.push(thisevent);\n\n        // Hide will be managed by cancel_popup after restoring the body overflow.\n        thisevent = bb.one('button.closebutton').on('click', function(e) {\n            cancelPopup(e);\n        });\n        listenevents.push(thisevent);\n\n        // Grab global keyup events and handle them\n        // thisevent = $(document).on('keydown', handleKeyPress(e));\n        // listenevents.push(thisevent);\n\n        // Display the panel\n        panel.show(e);\n\n        // Re-centre the dialogue after we've shown it.\n        centerDialogue(dialogue);\n\n        // Finally, focus the first radio element - this enables form selection via the keyboard.\n        container.find('.option input[type=radio]').focus();\n    };\n\n    return /** @alias module:core/activity_chooser_dialogue */{\n\n        /**\n         * Poll the server for any new notifications.\n         *\n         * @method fetchNotifications\n         */\n        setupChooserDialogue: setupChooserDialogue,\n\n        /**\n         * Add a notification to the page.\n         *\n         * Note: This does not cause the notification to be added to the session.\n         *\n         * @method addNotification\n         * @param {Object}  notification                The notification to add.\n         * @param {string}  notification.message        The body of the notification\n         * @param {string}  notification.type           The type of notification to add (error, warning, info, success).\n         * @param {Boolean} notification.closebutton    Whether to show the close button.\n         * @param {Boolean} notification.announce       Whether to announce to screen readers.\n         */\n        displayChooser: displayChooser,\n        updateHiddenRadioValue: updateHiddenRadioValue\n    };\n});\n"],"file":"activity_chooser_dialogue.min.js"}