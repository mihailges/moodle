{"version":3,"sources":["../src/activity_chooser_dialogue.js"],"names":["define","$","ActivityChooserEvents","FocusLock","ModalFactory","ModalEvents","Templates","cancelListenevents","thisevent","listenevents","length","shift","off","SELECTORS","CHOOSER_CONTAINER","CHOOSER_OPTIONS_CONTAINER","CHOOSER_OPTION_CONTAINER","CHOOSER_OPTION_ACTIONS_CONTAINER","CHOOSER_OPTION_INFO_CONTAINER","CHOOSER_OPTION_SUMMARY_CONTAINER","CHOOSER_OPTION_SUMMARY_CONTENT_CONTAINER","CHOOSER_OPTION_SUMMARY_ACTIONS_CONTAINER","CHOOSER_OPTION_ACTION_GROUP_ELEMENT","CHOOSER_OPTION_ACTIONS","SHOW_CHOOSER_OPTION_SUMMARY","ADD_CHOOSER_OPTION","CLOSE_CHOOSER_OPTION_SUMMARY","registerListenerEvents","on","e","optionSummaryElement","target","closest","find","showOptionSummary","removeClass","index","chooserOptions","totalChooserOptions","keyCode","nextIndex","focus","prevIndex","lastChooserOptionIndex","data","chooserOptionSummary","topPosition","scrollTop","height","outerHeight","addClass","setOptionSummaryPositionAndHeight","optionSummaryContentElement","cancelAction","addAction","trapFocus","attr","position","optionSumarryActionsElement","contentHeight","css","displayChooser","render","then","html","create","type","types","DEFAULT","body","title","large","modal","getRoot","shown","optionSummaryContentAnchors","each","key","anchor","bind","hidden","remove","show"],"mappings":"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","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * A system for displaying notifications to users from the session.\n *\n * Wrapper for the YUI M.core.notification class. Allows us to\n * use the YUI version in AMD code until it is replaced.\n *\n * @module     core/activity_chooser_dialogue\n * @package    core\n * @copyright  2019 Mihail Geshoski <mihail@moodle.com>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n * @since      3.8\n */\n\n// import {activityChooserEvents} from 'core/activity_chooser_events';\n// import {focusLock} from 'core/local/aria/focuslock';\n// import {modalFactory} from 'core/modal_factory';\n// import {modalEvents} from 'core/modal_events';\n// import {templates} from 'core/templates';\n//\n// import jQuery from 'jquery';\n//\n// const SELECTORS = {\n//     CHOOSER_CONTAINER: '[data-region=\"chooser-container\"]',\n//     CHOOSER_OPTIONS_CONTAINER: '[data-region=\"chooser-options-container\"]',\n//     CHOOSER_OPTION_CONTAINER: '[data-region=\"chooser-option-container\"]',\n//     CHOOSER_OPTION_ACTIONS_CONTAINER: '[data-region=\"chooser-option-actions-container\"]',\n//     CHOOSER_OPTION_INFO_CONTAINER: '[data-region=\"chooser-option-info-container\"]',\n//     CHOOSER_OPTION_SUMMARY_CONTAINER: '[data-region=\"chooser-option-summary-container\"]',\n//     CHOOSER_OPTION_SUMMARY_CONTENT_CONTAINER: '[data-region=\"chooser-option-summary-content-container\"]',\n//     CHOOSER_OPTION_SUMMARY_ACTIONS_CONTAINER: '[data-region=\"chooser-option-summary-actions-container\"]',\n//     CHOOSER_OPTION_ACTION_GROUP_ELEMENT: '[data-group=\"chooser-option-action\"]',\n//     CHOOSER_OPTION_ACTIONS: {\n//         SHOW_CHOOSER_OPTION_SUMMARY: '[data-action=\"show-option-summary\"]',\n//     },\n//     ADD_CHOOSER_OPTION: '[data-action=\"add-chooser-option\"]',\n//     CLOSE_CHOOSER_OPTION_SUMMARY: '[data-action=\"close-chooser-option-summary\"]',\n// };\n//\n// const showOptionSummary = optionSummaryElement => {\n//     var chooserContainerElement = document.querySelector(SELECTORS.CHOOSER_CONTAINER);\n//     // Get the current scroll position of the chooser container element.\n//     var topPosition = chooserContainerElement.scrollTop;\n//     // Get the height of the chooser container element.\n//     var height = chooserContainerElement.offsetHeight;\n//     // Disable the scroll of the chooser container element.\n//     chooserContainerElement.classList.add('noscroll');\n//\n//     setOptionSummaryPositionAndHeight(optionSummaryElement, topPosition, height);\n//\n//     var optionSummaryContentElement = optionSummaryElement\n//         .querySelector(SELECTORS.CHOOSER_OPTION_SUMMARY_CONTENT_CONTAINER);\n//     // Set the scroll of the type summary content element to top.\n//     if (optionSummaryContentElement.scrollTop > 0) {\n//         optionSummaryContentElement.scrollTop = 0;\n//     }\n//     // Show the particular summary overlay.\n//     optionSummaryElement.classList.add('open');\n//     var cancelOptionSummaryElement = optionSummaryElement.querySelector(SELECTORS.CLOSE_CHOOSER_OPTION_SUMMARY);\n//     var addOptionElement = optionSummaryElement.querySelector(SELECTORS.ADD_CHOOSER_OPTION);\n//\n//     focusLock.trapFocus(optionSummaryElement);\n//\n//     cancelOptionSummaryElement.setAttribute('tabindex', '0');\n//     addOptionElement.setAttribute('tabindex', '0');\n// };\n//\n// const setOptionSummaryPositionAndHeight = (optionSummaryElement, position, height) => {\n//     var optionSummaryContentElement = optionSummaryElement.querySelector(SELECTORS.CHOOSER_OPTION_SUMMARY_CONTENT_CONTAINER);\n//     var optionSumarryActionsElement = optionSummaryElement.querySelector(SELECTORS.CHOOSER_OPTION_SUMMARY_ACTIONS_CONTAINER);\n//     var contentHeight = height - optionSumarryActionsElement.offsetHeight;\n//     optionSummaryContentElement.style.height = contentHeight + 'px';\n//\n//     optionSummaryElement.style.top = position + 'px';\n//     optionSummaryElement.style.height = height + 'px';\n// };\n//\n// const registerListenerEvents = () => {\n//     // Show the chooser option summary.\n//     document.querySelectorAll(SELECTORS.CHOOSER_OPTION_ACTIONS.SHOW_CHOOSER_OPTION_SUMMARY)\n//         .forEach(function(showOptionSummaryElement) {\n//             showOptionSummaryElement.addEventListener('click', function(e) {\n//                 var optionSummaryElement = e.target.closest(SELECTORS.CHOOSER_OPTION_CONTAINER)\n//                     .querySelector(SELECTORS.CHOOSER_OPTION_SUMMARY_CONTAINER);\n//                 showOptionSummary(optionSummaryElement);\n//             });\n//         });\n//\n//     // Close the chooser option summary.\n//     document.querySelectorAll(SELECTORS.CLOSE_CHOOSER_OPTION_SUMMARY)\n//         .forEach(function(closeOptionSummaryElement) {\n//             closeOptionSummaryElement.addEventListener('click', function(e) {\n//                 var optionSummaryElement = e.target.closest(SELECTORS.CHOOSER_OPTION_CONTAINER)\n//                     .querySelector(SELECTORS.CHOOSER_OPTION_SUMMARY_CONTAINER);\n//                 optionSummaryElement.classList.remove('open');\n//                 document.querySelector(SELECTORS.CHOOSER_CONTAINER).classList.remove('noscroll');\n//             });\n//         });\n//\n//     var chooserOptions = document.querySelectorAll(SELECTORS.CHOOSER_OPTION_CONTAINER);\n//     chooserOptions.forEach(function(chooserOptionElement, index, chooserOptions) {\n//         chooserOptionElement.addEventListener('keydown', function(e, index, chooserOptions) {\n//             var totalChooserOptions = chooserOptions.length;\n//\n//             // Right key or down key.\n//             if (e.keyCode === 39 || e.keyCode === 40) {\n//                 var nextIndex = index + 1;\n//                 if (typeof chooserOptions[nextIndex] === 'undefined') {\n//                     return;\n//                 }\n//                 chooserOptions[nextIndex].focus();\n//             }\n//\n//             // Left key.\n//             if (e.keyCode === 37 || e.keyCode === 38) {\n//                 var prevIndex = index - 1;\n//                 if (typeof chooserOptions[prevIndex] === 'undefined') {\n//                     return;\n//                 }\n//                 chooserOptions[prevIndex].focus();\n//             }\n//\n//             // End key.\n//             if (e.keyCode === 35) {\n//                 var lastChooserOptionIndex = totalChooserOptions - 1;\n//                 if (index === lastChooserOptionIndex) {\n//                     return;\n//                 }\n//                 chooserOptions[lastChooserOptionIndex].focus();\n//             }\n//\n//             // Home key.\n//             if (e.keyCode === 36) {\n//                 var firstChooserOptionIndex = 0;\n//                 if (index === firstChooserOptionIndex) {\n//                     return;\n//                 }\n//                 chooserOptions[firstChooserOptionIndex].focus();\n//             }\n//         });\n//     });\n//\n//     var chooserOptions = document.querySelectorAll(SELECTORS.CHOOSER_OPTION_CONTAINER);\n//     chooserOptions.forEach(function(chooserOptionElement, index, chooserOptions) {\n//         chooserOptionElement.addEventListener('keydown', function(e, index, chooserOptions) {\n//             var totalChooserOptions = chooserOptions.length;\n//         });\n//\n//     $(SELECTORS.CHOOSER_OPTION_ACTION_GROUP_ELEMENT).on('keydown', function(e) {\n//         if (e.keyCode === 13) {\n//             if ($(this).data('action') === 'show-option-summary') {\n//                 var chooserOptionSummary = $(this).closest(SELECTORS.CHOOSER_OPTION_CONTAINER)\n//                     .find(SELECTORS.CHOOSER_OPTION_SUMMARY_CONTAINER);\n//                 showOptionSummary(chooserOptionSummary);\n//             }\n//         }\n//     });\n// };\n\n\ndefine(\n    [\n        'jquery',\n        'core/activity_chooser_events',\n        'core/local/aria/focuslock',\n        'core/modal_factory',\n        'core/modal_events',\n        'core/templates'\n    ],\n    function(\n        $,\n        ActivityChooserEvents,\n        FocusLock,\n        ModalFactory,\n        ModalEvents,\n        Templates\n    ) {\n\n    /**\n     * Cancel any listen events in the listenevents queue\n     *\n     * Several locations add event handlers which should only be called before the form is submitted. This provides\n     * a way of cancelling those events.\n     *\n     * @method cancel_listenevents\n     */\n    var cancelListenevents = function() {\n        // Detach all listen events to prevent duplicate triggers\n        var thisevent;\n        while (listenevents.length) {\n            thisevent = listenevents.shift();\n            $(thisevent).off();\n        }\n    };\n\n    var hide = function() {\n        // Cancel all listen events\n        cancelListenevents();\n        container.off();\n        panel.hide();\n    };\n\n    var SELECTORS = {\n        CHOOSER_CONTAINER: '[data-region=\"chooser-container\"]',\n        CHOOSER_OPTIONS_CONTAINER: '[data-region=\"chooser-options-container\"]',\n        CHOOSER_OPTION_CONTAINER: '[data-region=\"chooser-option-container\"]',\n        CHOOSER_OPTION_ACTIONS_CONTAINER: '[data-region=\"chooser-option-actions-container\"]',\n        CHOOSER_OPTION_INFO_CONTAINER: '[data-region=\"chooser-option-info-container\"]',\n        CHOOSER_OPTION_SUMMARY_CONTAINER: '[data-region=\"chooser-option-summary-container\"]',\n        CHOOSER_OPTION_SUMMARY_CONTENT_CONTAINER: '[data-region=\"chooser-option-summary-content-container\"]',\n        CHOOSER_OPTION_SUMMARY_ACTIONS_CONTAINER: '[data-region=\"chooser-option-summary-actions-container\"]',\n        CHOOSER_OPTION_ACTION_GROUP_ELEMENT: '[data-group=\"chooser-option-action\"]',\n        CHOOSER_OPTION_ACTIONS: {\n            SHOW_CHOOSER_OPTION_SUMMARY: '[data-action=\"show-option-summary\"]',\n        },\n        ADD_CHOOSER_OPTION: '[data-action=\"add-chooser-option\"]',\n        CLOSE_CHOOSER_OPTION_SUMMARY: '[data-action=\"close-chooser-option-summary\"]',\n    };\n\n    var registerListenerEvents = function() {\n\n        // Show the chooser option summary.\n        $(SELECTORS.CHOOSER_OPTION_ACTIONS.SHOW_CHOOSER_OPTION_SUMMARY).on('click', function(e) {\n            var optionSummaryElement = $(e.target).closest(SELECTORS.CHOOSER_OPTION_CONTAINER)\n                .find(SELECTORS.CHOOSER_OPTION_SUMMARY_CONTAINER);\n            showOptionSummary(optionSummaryElement);\n        });\n\n        // Close the chooser option summary.\n        $(SELECTORS.CLOSE_CHOOSER_OPTION_SUMMARY).on('click', function(e) {\n            var optionSummaryElement = $(e.target).closest(SELECTORS.CHOOSER_OPTION_CONTAINER)\n                .find(SELECTORS.CHOOSER_OPTION_SUMMARY_CONTAINER);\n            optionSummaryElement.removeClass('open');\n            $(SELECTORS.CHOOSER_CONTAINER).removeClass('noscroll');\n        });\n\n        $(SELECTORS.CHOOSER_OPTION_CONTAINER).on('keydown', function(e) {\n            var index = $(this).index();\n            var chooserOptions = $(SELECTORS.CHOOSER_OPTIONS_CONTAINER).find(SELECTORS.CHOOSER_OPTION_CONTAINER);\n            var totalChooserOptions = chooserOptions.length;\n\n            // Right key or down key.\n            if (e.keyCode === 39 || e.keyCode === 40) {\n                var nextIndex = index + 1;\n                if (typeof chooserOptions[nextIndex] === 'undefined') {\n                    return;\n                }\n                $(chooserOptions[nextIndex]).focus();\n            }\n\n            // Left key.\n            if (e.keyCode === 37 || e.keyCode === 38) {\n                var prevIndex = index - 1;\n                if (typeof chooserOptions[prevIndex] === 'undefined') {\n                    return;\n                }\n                $(chooserOptions[prevIndex]).focus();\n            }\n\n            // End key.\n            if (e.keyCode === 35) {\n                var lastChooserOptionIndex = totalChooserOptions - 1;\n                if (index === lastChooserOptionIndex) {\n                    return;\n                }\n                $(chooserOptions[lastChooserOptionIndex]).focus();\n            }\n\n            // Home key.\n            if (e.keyCode === 36) {\n                var firstChooserOptionIndex = 0;\n                if (index === firstChooserOptionIndex) {\n                    return;\n                }\n                $(chooserOptions[firstChooserOptionIndex]).focus();\n            }\n        });\n\n        $(SELECTORS.CHOOSER_OPTION_ACTION_GROUP_ELEMENT).on('keydown', function(e) {\n            if (e.keyCode === 13) {\n                if ($(this).data('action') === 'show-option-summary') {\n                    var chooserOptionSummary = $(this).closest(SELECTORS.CHOOSER_OPTION_CONTAINER)\n                        .find(SELECTORS.CHOOSER_OPTION_SUMMARY_CONTAINER);\n                    showOptionSummary(chooserOptionSummary);\n                }\n            }\n        });\n    };\n\n    var showOptionSummary = function(optionSummaryElement) {\n        // Get the current scroll position of the chooser container element.\n        var topPosition = $(SELECTORS.CHOOSER_CONTAINER).scrollTop();\n        // Get the height of the chooser container element.\n        var height = $(SELECTORS.CHOOSER_CONTAINER).outerHeight();\n        // Disable the scroll of the chooser container element.\n        $(SELECTORS.CHOOSER_CONTAINER).addClass('noscroll');\n\n        setOptionSummaryPositionAndHeight(optionSummaryElement, topPosition, height);\n\n        var optionSummaryContentElement = optionSummaryElement.find(SELECTORS.CHOOSER_OPTION_SUMMARY_CONTENT_CONTAINER);\n        // Set the scroll of the type summary content element to top.\n        if (optionSummaryContentElement.scrollTop() > 0) {\n            optionSummaryContentElement.scrollTop(0);\n        }\n        // Show the particular summary overlay.\n        optionSummaryElement.addClass('open');\n        var cancelAction = optionSummaryElement.find(SELECTORS.CLOSE_CHOOSER_OPTION_SUMMARY);\n        var addAction = optionSummaryElement.find(SELECTORS.ADD_CHOOSER_OPTION);\n\n        FocusLock.trapFocus($(optionSummaryElement));\n\n        $(cancelAction).attr('tabindex', 0);\n        $(addAction).attr('tabindex', 0);\n    };\n\n    var setOptionSummaryPositionAndHeight = function(optionSummaryElement, position, height) {\n        var optionSummaryContentElement = optionSummaryElement.find(SELECTORS.CHOOSER_OPTION_SUMMARY_CONTENT_CONTAINER);\n        var optionSumarryActionsElement = optionSummaryElement.find(SELECTORS.CHOOSER_OPTION_SUMMARY_ACTIONS_CONTAINER);\n        var contentHeight = height - optionSumarryActionsElement.outerHeight();\n        optionSummaryContentElement.css({'height' : contentHeight + 'px'});\n\n        optionSummaryElement.css({'top' : position + 'px', 'height' : height + 'px'});\n    };\n\n    /**\n      * Display the module chooser.\n      *\n      * @method display_chooser\n      * @param {EventFacade} e Triggering Event\n      */\n    var displayChooser = function(e, data) {\n        return Templates.render('core_course/modchooser', data)\n            .then(function(html) {\n                return ModalFactory.create({\n                    type: ModalFactory.types.DEFAULT,\n                    body: html,\n                    title: data.title,\n                    large: true\n                }).then(function(modal) {\n                    modal.getRoot().on(ModalEvents.shown, function() {\n                        var optionSummaryContentAnchors = $(SELECTORS.CHOOSER_OPTION_SUMMARY_CONTENT_CONTAINER).find('a');\n                        optionSummaryContentAnchors.each(function(key, anchor) {\n                            $(anchor).attr('tabindex', -1);\n                        });\n                        registerListenerEvents();\n                    }.bind(this));\n\n                    // We want to focus on the action select when the dialog is closed.\n                    modal.getRoot().on(ModalEvents.hidden, function() {\n                        $(e.target.closest('.chooser-link')).focus();\n                        modal.getRoot().remove();\n                    }.bind(this));\n\n                    modal.show();\n                });\n            });\n    };\n\n    return /** @alias module:core/activity_chooser_dialogue */{\n        /**\n         * Add a notification to the page.\n         *\n         * Note: This does not cause the notification to be added to the session.\n         *\n         * @method addNotification\n         * @param {Object}  notification                The notification to add.\n         * @param {string}  notification.message        The body of the notification\n         * @param {string}  notification.type           The type of notification to add (error, warning, info, success).\n         * @param {Boolean} notification.closebutton    Whether to show the close button.\n         * @param {Boolean} notification.announce       Whether to announce to screen readers.\n         */\n        displayChooser: displayChooser\n    };\n});\n"],"file":"activity_chooser_dialogue.min.js"}