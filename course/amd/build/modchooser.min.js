define(["core/yui","jquery","core/activity_chooser_dialogue","core/pubsub","core/activity_chooser_events"],function(a,b,c,d,e){var f={PAGECONTENT:"body",SECTION:null,SECTIONMODCHOOSER:"span.section-modchooser-link",SITEMENU:".block_site_main_menu",SITETOPIC:"div.sitetopic"},g=null,h=function(a){if(b(a.currentTarget).parents(f.SITETOPIC).length)g=1;else if(b(a.currentTarget).parents(f.SECTION).length){var d=b(a.currentTarget).parents(f.SECTION);g=d.attr("id").replace("section-","")}else b(a.currentTarget).parents(f.SITEMENU).length&&(g=0);c.displayChooser(a)},i=function(a){var c=b(a).find(f.SECTIONMODCHOOSER);if(c.length){var d="<a href='#' class='chooser-link' />";b(c).children().wrapAll(d),b(".chooser-link").on("click",function(a){a.preventDefault(),h(a)})}},j=function(a){a||(a=f.PAGECONTENT),b(a).find(f.SITETOPIC).each(function(){i(this)}),f.SECTION&&b(a).find(f.SECTION).each(function(){i(this)}),b(a).find(f.SITEMENU).each(function(){i(this)}),b(".testtt").on("click",function(a){a.preventDefault(),h(a)})},k=function(a){c.updateHiddenRadioValue("jump",a.value+"&section="+g)},l=function(){a.use("moodle-course-coursebase",function(){var a=M.course.format.get_sectionwrapperclass();a&&(f.SECTION="."+a);var d=b(".chooserdialoguebody"),e=b(".choosertitle"),g={};c.setupChooserDialogue(d,e,g),j()}),d.subscribe(e.OPTION_SELECTED,k)};return{init:l}});